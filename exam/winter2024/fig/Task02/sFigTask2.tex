%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SolutionFigure
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{solutionfigure}[htb]  
    \begin{center}
        \definecolor{orange}{rgb}{1.0,0.5,0}
        \begin{tikzpicture}
            % groupplot begin
            \begin{groupplot}[group style={
                group size=1 by 7,
                xlabels at=edge bottom,
                y descriptions at=edge left,
                },
                domain=0:15,
                % x/y range adjustment
                xmin=0, xmax=66,
                ymin=-4.5, ymax=4.5,
                samples=500,
                axis y line=center,
                axis x line=middle,
                extra y ticks=0,
                % Label text
                xlabel={$t / \SI{}{\micro\second}$},,
                % Label adjustment
                x label style={at={(axis description cs:1,0.5)},anchor=west},
                y label style={at={(axis description cs:-.05,.97)},anchor=south},
                width=0.95\textwidth,
                height=0.3\textwidth,
                % x-Ticks
                xtick={ 0, 2, 4, 6, 8,10,12,14,16,18,
                        20,22,24,26,28,30,32,34,36,38,
                        40,42,44,46,48,50,52,54,56,58,
                        60,62,64},
                xticklabels={0,,,,,10,,,,,20
                              ,,,,,30,,,,,40
                              ,,,,,50,,,,,60
                              ,,},
                xticklabel style = {yshift=0.1cm,anchor=north},
                % Grid layout
                grid=both,
                grid style={line width=.1pt, draw=gray!10},
                major grid style={line width=.2pt,draw=gray!50},
                ]
                \nextgroupplot[
                    ymin=-3.5, ymax=3.5,
                    samples=500,
                    extra y ticks=0,
                    % x-Label text
                    xlabel={$t / \SI{}{\micro\second}$},,                    
                    % y-Label
                    y label style={at={(axis description cs:-.05,1)},anchor=south},
                    height=0.25\textwidth,
                    ylabel={\color{black}$u(t)/\mathrm{V}$},
                    % y-Ticks
                    ytick={3,2,1,0,-1,-2,-3},
                    yticklabels={3,,,0,,,-3},
                    yticklabel style = {anchor=east},  
                ]
                % Voltage u1a(wt)
                \addplot[black, domain= 0:12,solid,line width=1pt] {x/2-3};
                \addplot[black, domain= 12:24,solid,line width=1pt] {3-(x-12)/2};
                \addplot[black, domain= 24:36,solid,line width=1pt] {(x-24)/2-3};
                \addplot[black, domain= 36:48,solid,line width=1pt] {3-(x-36)/2};
                \addplot[black, domain= 48:60,solid,line width=1pt] {(x-48)/2-3};
                \addplot[black, domain= 60:64,solid,line width=1pt] {3-(x-60)/2};
                % Label for carrier
                \node[scale=0.8] at (axis cs:20,2.5){$\text{Triangular carrier}$};

                % Label for reference voltage
                \node[scale=0.8,color=blue] at (axis cs:48,1.5){$\text{Reference voltage}$};
                \addplot[color=blue,mark=none,solid,line width=1pt] coordinates{
                    (0, 1)
                    (24, 1)
                    (24, -1)
                    (36, -1)
                    (36, 1)
                    (64, 1)
                    };      
                \addplot[color=black,mark=none,dashed,line width=1pt] coordinates{
                    (0, -1)
                    (24, -1)
                    (24, 1)
                    (36, 1)
                    (36, -1)
                    (64, -1)
                    };

                \nextgroupplot[
                    ymin=0, ymax=500,
                    samples=500,
                    extra y ticks=0,
                    % x-Label text
                    xlabel={$t / \SI{}{\micro\second}$},,
                    x label style={at={(axis description cs:1,0)},anchor=west},                    
                    % y-Label
                    y label style={at={(axis description cs:-.05,1)},anchor=south},
                    height=0.15\textwidth,
                    ylabel={\color{black}$u_\text{a}(t)/\mathrm{V}$},
                    ytick={0,150,300,450},
                    yticklabels={,,,},
                    yticklabel style = {anchor=east},                        
                    xticklabel style = {yshift=-0.3cm,anchor=north},
                    % solution y-tick labels
                    yticklabels={,,,450},
                    ]                
                    \addplot[color=blue,mark=none,solid,line width=1pt] coordinates{
                        (0, 450)
                        (8, 450)
                        (8, 0)
                        (16, 0)
                        (16, 450)
                        (28, 450)
                        (28, 0)
                        (40, 0)
                        (40, 450)
                        (56, 450)
                        (56, 0)
                        (61, 0)
                    };
            
                \nextgroupplot[
                    ymin=0, ymax=500,
                    samples=500,
                    extra y ticks=0,
                    % x-Label text
                    xlabel={$t / \SI{}{\micro\second}$},,
                    x label style={at={(axis description cs:1,0)},anchor=west},
                    % y-Label
                    y label style={at={(axis description cs:-.05,1)},anchor=south},
                    height=0.15\textwidth,
                    ylabel={\color{black}$u_\text{b}(t)/\mathrm{V}$},
                    ytick={0,150,300,450},
                    yticklabels={,,,},
                    yticklabel style = {anchor=east},                        
                    xticklabel style = {yshift=-0.3cm,anchor=north},
                    % solution y-tick labels
                    yticklabels={,,,450},
                ]
                \addplot[color=blue,mark=none,solid,line width=1pt] coordinates{
                    (0, 450)
                    (4, 450)
                    (4, 0)
                    (20, 0)
                    (20, 450)
                    (32, 450)
                    (32, 0)
                    (44, 0)
                    (44, 450)
                    (52, 450)
                    (52, 0)
                    (61, 0)
                };                    

                \nextgroupplot[
                    ymin=-500, ymax=500,
                    samples=500,
                    extra y ticks=0,
                    % x-Label text
                    xlabel={$t / \SI{}{\micro\second}$},,                    
                    % y-Label
                    y label style={at={(axis description cs:-.05,1)},anchor=south},
                    height=0.25\textwidth,
                    ylabel={\color{black}$u_\text{ab}(t)/\mathrm{V}$},
                    ytick={-450,-300,-150,0,150,300,450},
                    yticklabels={,,,,,,},
                    yticklabel style = {anchor=east},                        
                    xticklabel style = {yshift=-0.3cm,anchor=north},
                    % solution y-tick labels
                    yticklabels={-450,,,,,,450},                        
                ]
                \addplot[color=blue,mark=none,solid,line width=1pt] coordinates{
                    (0, 0)
                    (4, 0)
                    (4, 450)
                    (8, 450)
                    (8, 0)
                    (16, 0)
                    (16, 450)
                    (20, 450)
                    (20, 0)
                    (28, 0)
                    (28, -450)
                    (32, -450)
                    (32, 0)
                    (40, 0)
                    (40, 450)
                    (44, 450)
                    (44, 0)
                    (52, 0)
                    (52, 450)
                    (56, 450)
                    (56, 0)
                    (61, 0)
                };
            
                \nextgroupplot[
                    ymin=-45, ymax=45,
                    samples=500,
                    extra y ticks=0,
                    % x-Label text
                    xlabel={$t / \SI{}{\micro\second}$},,                    
                    % y-Label
                    y label style={at={(axis description cs:-.05,1)},anchor=south},
                    height=0.25\textwidth,
                    ylabel={\color{black}$i_\text{2}(t)/\mathrm{A}$},
                    ytick={-40,-30,-20,-10,0,10,20,30,40},
                    yticklabels={-40,,-20,,0,,20,,40},
                    yticklabel style = {anchor=east},                        
                ]
                \addplot[color=red,mark=none,solid,line width=1pt] coordinates{
                    (0, 30)
                    (4, 20)
                    (4, 20)
                    (8, 40)
                    (8, 40)
                    (16, 20)
                    (16, 20)
                    (20, 40)
                    (20, 40)
                    (28, 20)
                    (28, 20)
                    (32, -20)
                    (32, -20)
                    (40, -40)
                    (40, -40)
                    (44, -20)
                    (44, -20)
                    (52, -40)
                    (52, -40)
                    (56, -20)
                    (56, -20)
                    (61, -22.5)
                };

                \nextgroupplot[
                    ymin=-45, ymax=45,
                    samples=500,
                    extra y ticks=0,
                    % x-Label text
                    xlabel={$t / \SI{}{\micro\second}$},,                    
                    % y-Label
                    y label style={at={(axis description cs:-.05,1)},anchor=south},
                    height=0.25\textwidth,
                    ylabel={\color{black}$i_\text{1}(t)/\mathrm{A}$},
                    ytick={-40,-30,-20,-10,0,10,20,30,40},
                    yticklabels={-40,,-20,,0,,20,,40},
                    yticklabel style = {anchor=east},                        
                ]
                \addplot[color=red,mark=none,solid,line width=1pt] coordinates{
                    (0, 0)
                    (4, 0)
                    (4, 20)
                    (8, 40)
                    (8, 0)
                    (16, 0)
                    (16, 20)
                    (20, 40)
                    (20, 0)
                    (28, 0)
                    (28, 20)
                    (32, -20)
                    (32, 0)
                    (40, 0)
                    (40, -40)
                    (44, -20)
                    (44, 0)
                    (52, 0)
                    (52, -40)
                    (56, -20)
                    (56, 0)
                    (61, 0)
                };

                \nextgroupplot[
                    ymin=0, ymax=1.5,
                    samples=500,
                    extra y ticks=0,
                    % x-Label text
                    x label style={at={(axis description cs:1,0)},anchor=west},
                    xlabel={$t / \SI{}{\micro\second}$},,                    
                    % y-Label
                    height=0.15\textwidth,
                    ytick={0,3},
                    yticklabels={,},
                    yticklabel style = {yshift=-0.2cm,anchor=east},
                    xmajorgrids=false, % Kein Grid auf der x-Achse
                    ymajorgrids=false  % Kein Grid auf der y-Achse
                ]
                % Label for the diagram
                \node[scale=0.8] at (axis cs:30,1.3){$\text{Component conduction ranges}$};  
                
                \node[scale=0.7] at (axis cs:2,0.5){$T_\text{1}/D_\text{3}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (4, 0)
                    (4, 1)
                };
                \node[scale=0.7] at (axis cs:6,0.5){$T_\text{1}/T_\text{4}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (8, 0)
                    (8, 1)
                };
                \node[scale=0.7] at (axis cs:12,0.5){$D_\text{2}/T_\text{4}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (16, 0)
                    (16, 1)
                };
                \node[scale=0.7] at (axis cs:18,0.5){$T_\text{1}/T_\text{4}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (20, 0)
                    (20, 1)
                };
                \node[scale=0.7] at (axis cs:24,0.5){$T_\text{1}/D_\text{3}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (28, 0)
                    (28, 1)
                };
                \node[scale=0.6,rotate=90] at (axis cs:29,0.5){$D_\text{2}/D_\text{3}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (30, 0)
                    (30, 1)
                };
                \node[scale=0.6,rotate=90] at (axis cs:31,0.5){$T_\text{2}/T_\text{3}$};
                \addplot[color=black,mark=none,solid,thick] coordinates{
                    (32, 0)
                    (32, 1)
                };
                \node[scale=0.7] at (axis cs:37,0.5){$T_\text{2}/D_\text{4}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (40, 0)
                    (40, 1)
                };
                \node[scale=0.7] at (axis cs:42,0.5){$D_\text{1}/D_\text{4}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (44, 0)
                    (44, 1)
                };
                \node[scale=0.7] at (axis cs:48,0.5){$T_\text{3}/D_\text{1}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (52, 0)
                    (52, 1)
                };
                \node[scale=0.7] at (axis cs:54,0.5){$D_\text{1}/D_\text{4}$};
                \addplot[color=black,mark=none,solid, thick] coordinates{
                    (56, 0)
                    (56, 1)
                };
                \node[scale=0.7] at (axis cs:58,0.5){$T_\text{2}/D_\text{4}$};
            \end{groupplot}
        \end{tikzpicture}
    \end{center}
    \caption{Relevant voltage and current signals of the four-quadrant converter.}
    \label{fig:solutionfigureTask2}
\end{solutionfigure}       
