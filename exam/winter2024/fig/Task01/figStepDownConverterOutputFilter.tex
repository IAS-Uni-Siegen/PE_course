%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% StepDownConverterOutputFilter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[htb]
    \begin{center}
        \begin{circuitikz}[european currents,european resistors,american inductors]
            \draw
            (0,0) coordinate(U+) to [short,-] ++(0.5,0)  
            node[currarrow](Tl){} -- ++(1,0) ++(0.8,0) node[nigbt,rotate=90](Trans){} ++(0.7,0) coordinate (Te)
            (Te) to [short,-*] ++(1,0) coordinate(junc1) -- ++(0.5,0) coordinate(Ll) to [L,l_=$L$,i^=$i_\text{L}$]
            ++(2,0) coordinate(Lr) to [short,-*] ++(0.5,0) coordinate(junc2)  -- ++(2,0)
            coordinate(Rt) to [R,l_=$R$,i_=$I_\text{2}$,v^=$U_\text{2}$,voltage shift=0.5, voltage=straight] ++(0,-3) coordinate(Rb)
            to [short,-*] ++(-2,0) coordinate(junc3) to [short,-*] ++(-3,0) coordinate(junc4) to [short] ++(-2,0)
            coordinate(junc5) to [short,-] ++(-2,0) coordinate(U-)
            (junc2) to [C,l_=$C$](junc3)
            (junc4) to [short]  ++(0,0.5) coordinate(Db) to[D-,l^=$D_1$]  ++(0,2) coordinate(Dt) to [short] (junc1)
            (Trans.G)  to [sqV] ++(0,-1)(junc5) 
            (U+) to [V=$U_1$] (U-)
            (Trans)  node[anchor=south,color=black]{$T_1$}	
            (Tl)  node[anchor=south,color=black]{$i_\text{1}$}	
            %  Add arrow for U_s
            (junc1) ++(0.7,0) to [open,v^=$$,voltage = straight] ++(0,-3)
            (junc1) ++(1.2,-2) node[anchor=south,color=black]{$u_\mathrm{s}(t)$}
            ;
        \end{circuitikz}
    \end{center}
    \caption{Circuit with one transistor, filter and one load resistor.}
    \label{fig:step_down_converter_output_filter}
\end{figure}

%(ju2) ++(1.2,-0.5)  to [open,v^=$$,voltage = straight] (jmu2x)
%(ju2) ++ (3.5,-0.5) node[anchor=north,color=black]{$u_\mathrm{2ab}(t)$}
