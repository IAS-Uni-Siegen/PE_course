%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Task 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\task{Line-commuted three-phase rectifier}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\taskGerman{Netzgeführter dreiphasiger Gleichrichter}
% Tasks centered around M3C circuit with an inner voltage source and an R-L filter element in series at the output side -> plot circuit at the beginning. at the beginning L-> infty can be assumed and R plus u_i have some fitting value.
% Question 1: provide a prepared sketch of the three-phase secondary voltage before the thyristors for two fundamental periods -> the students should insert the output voltage curve u_2 right of the thyristors for alpha = 6o°
% Question 2: The students should calculate the average output voltage for alpha = 60°
% Question 3: The students should calculate the average load current 
% Question 4: The students should calculate the power losses in R as well as the power transfered to u_i
% Question 5: given some specific DCM scenario plot (provided by us), i.e., L < infty and the load current temporarily reaches zero, the students should calculate the average output voltage

A controlled three-phase midpoint rectifier (M3C) charges a battery of an electric motorbike, with $R = \SI{0.1}{\Omega}$ modeling the internal resistance of the battery, and $U_\mathrm{batt} = \SI{125}{\volt}$ as the battery voltage. An inductor filter $L$ is used to smooth the output current $I_\mathrm{2}$, with an inductance that is, initially, assumed to be infinitely large. The ideal transformer in the converter is connected to a symmetrical three-phase grid with an effective phase voltage $U_\mathrm{N}=\SI{230}{\volt}$ and line-to-line voltage of $U_\mathrm{N,LL} = \SI{400}{\volt}$. The phase voltage on the secondary side of the transformer has effective value of $U_\mathrm{1,i} = \SI{230}{\volt}$, $\forall i=\mathrm{a, b, c}.$ The switching components are assumed to be ideal. \\
\color{gray}
Ein gesteuerter Dreiphasen-Mittelpunkt-Gleichrichter (M3C) lädt die Batterie eines Elektromotorrads, wobei $R = \SI{0,1}{\Omega}$ den Innenwiderstand der Batterie modelliert und $U_\mathrm{batt} = \SI{125}{\volt}$ die Batteriespannung ist. Ein
Induktionsfilter $L$ wird zur Glättung des Ausgangsstroms $I_\mathrm{2}$ verwendet, wobei die Induktivität zunächst als unendlich groß angenommen wird. Der ideale Transformator im Konverter ist an ein symmetrisches dreiphasiges Netz mit einer effektiven Phasenspannung $U_\mathrm{N}=\SI{230}{\volt}$ und einer Leiter-Leiter-Spannung von $U_\mathrm{N,LL} = \SI{400}{\volt}$ angeschlossen. Die Phasenspannung auf der Sekundärseite des Transformators hat einen Effektivwert von $U_\mathrm{1,i} = \SI{230}{\volt}$, $\forall i=\mathrm{a, b, c}.$ Die Schaltkomponenten sind als ideal anzunehmen.
\color{black}
\input{fig/Task03/Fig_M3C_with_RLE_load}

\subtask{Draw the output voltage signal $u_2(t)$ for the control angle $\alpha=\frac{\pi}{3}$ into \autoref{fig:Task03_M3C_with_RLE}.}{2}
\subtaskGerman{Zeichnen Sie der Ausgangsspannung $u_2(t)$ für den Steuerwinkel $\alpha=\frac{\pi}{3}$ in \autoref{fig:Task03_M3C_with_RLE}.}
\input{fig/Task03/Three-phase_secondary_voltage}
\begin{solutionblock}
\input{fig/Task03/sFig_subtask3.1_output_voltage}
\end{solutionblock}
\subtask{For the same $\alpha$, calculate the average output voltage $\bar{u}_\mathrm{2}$.}{2}
\subtaskGerman{ Berechnen Sie für dasselbe $\alpha$ die mittlere Ausgangsspannung $\bar{u}_\mathrm{2}$}
\begin{solutionblock}
Recalling the average output voltage equation in CCM:
$$\bar{u}_\mathrm{2}(\alpha) = \frac{3\sqrt{3}}{2\pi}\hat{u}_\mathrm{1}\cos(\alpha),$$            
where the peak value $\hat{u}_\mathrm{1}$ can be calculated as:
$$ \hat{u}_\mathrm{1} = \sqrt{2}U_\mathrm{1}= \sqrt{2}\cdot\SI{230}{\volt} \approx \SI{325.27}{\volt}.$$
Hence, the average output voltage is:
$$ \bar{u}_\mathrm{2}(\alpha=\frac{\pi}{3}) = \frac{3\sqrt{3}}{2\pi}\cdot \SI{325.27}{\volt}\cdot\cos(\frac{\pi}{3}) \approx \SI{134.5}{\volt}.$$
\end{solutionblock}
\subtask{Calculate the corresponding average load current $I_\mathrm{2}$.}{1}
\subtaskGerman{Berechnen Sie den entsprechenden mittleren Laststrom $I_2$.}
\begin{solutionblock}
The average output voltage can be written as:
$$ \bar{u}_\mathrm{2}(\alpha) = I_\mathrm{2}R + U_\mathrm{batt}.$$
Accordingly, the average output current can be calculated as:
$$  I_\mathrm{2} =  \frac{\bar{u}_\mathrm{2}(\alpha) - U_\mathrm{batt}}{R}=  \frac{\SI{134.5}{\volt} - \SI{125}{\volt}}{\SI{0.1}{\Omega}} = \SI{95}{\ampere}.$$
\end{solutionblock}
\subtask{Calculate the power loss in the resistor and the power delivered to the battery $U_\mathrm{batt}$.}{2}
\subtaskGerman{Berechnen Sie die an die Batterie $U_\mathrm{batt}$ abgegebene Leistung und die Verluste im Widerstand.}
\begin{solutionblock}
The power dissipated by the resistor can be calculated by:
            $$ P_\mathrm{resistor} = I^2_\mathrm{2} \cdot R = (\SI{95}{\ampere})^2 \cdot \SI{0.1}{\Omega} = \SI{902.5}{\watt},$$
            or using the voltage across the resistor by:
           $$ P_\mathrm{resistor} = (\bar{u}_\mathrm{2}(\alpha=\frac{\pi}{3}) - U_\mathrm{batt})\cdot I_\mathrm{2} = (\SI{134.5}{\volt} - \SI{125}{\volt}) \cdot \SI{95}{\ampere} = \SI{902.5}{\watt},$$
while the power delivered to $U_\mathrm{batt}$ is:
           $$ P_\mathrm{batt} =U_\mathrm{batt}\cdot I_\mathrm{2} = \SI{125}{\volt} \cdot \SI{95}{\ampere} = \SI{11.875}{\kilo\watt}.$$
\end{solutionblock}
\subtask{Consider the case where the inductance $L$ is finite, such that the converter operates in DCM. For an output voltage $u_\mathrm{2}$ where $\alpha = \frac{\pi}{3}$ and $\beta = \frac{\pi}{2}$, as shown in \autoref{fig:M3C_dcm}, calculate the average output voltage $\bar{u}_\mathrm{2}$.}{3}
\begin{hintblock}
In this question, the DCM is directly influenced by the presence of the battery voltage, which is different from having a capacitive filter at the output.
\end{hintblock}
\subtaskGerman{Betrachten Sie den Fall, dass die Induktivität $L$ nun nur noch endlich groß ist, so dass der Wandler im Lückebetrieb arbeitet,
wie in \autoref{fig:M3C_dcm} dargestellt. Für $\alpha = \frac{\pi}{3}$ und $\beta = \frac{\pi}{2}$ ist die mittlere Ausgangsspannung zu berechnen.}
\begin{germanhintblock}
In dieser Frage wird der DCM direkt von der Batteriespannung beeinflusst, was sich von einem kapazitiven Filter am Ausgang unterscheidet.
\end{germanhintblock}

\input{fig/Task03/DCM_scenario}
\begin{solutionblock}
In DCM mode, the inductor's current falls below the thyristors holding current, resulting in all thyristors stop conducting during certain intervals within the cycle. Since the output voltage during the non-conducting intervals is $u_\mathrm{2}(t) = U_\mathrm{batt}$, the average output voltage can be calculated as:

            $$\bar{u}_\mathrm{2}(\beta) = \frac{3}{2\pi} \left[\int_{0}^{\beta} \hat{u}_\mathrm{1}\cos(\omega t) \mathrm{d}\omega t +  \int_{\beta}^{\frac{2\pi}{3}} U_\mathrm{batt} \mathrm{d}\omega t \right].$$
            After integration, we get
           $$  \bar{u}_\mathrm{2}(\beta) = \frac{3}{2\pi} \left[ \hat{u}_\mathrm{1}(\sin(\beta)-\sin(0))  + U_\mathrm{batt} (\frac{2\pi}{3} - \beta)\right].$$
            So, for the given $\beta =\frac{\pi}{2}$, the average output voltage is
           $$  \bar{u}_\mathrm{2}(\beta) = \frac{3}{2\pi} \left[ \SI{325.27}{\volt}\cdot(\sin(\frac{\pi}{2})-\sin(0))  + \SI{125}{\volt} \cdot (\frac{2\pi}{3} - \frac{\pi}{2})\right] \approx \SI{186.55}{\volt}.$$

\end{solutionblock}