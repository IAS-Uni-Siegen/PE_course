%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Examtask 1: Step-up converter with output filter %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\task{Step-up converter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\taskGerman{Hochsetzsteller}
%%%%%%%%%%%
% Combination of Tasks 1.2 + 1.3 from our exercises (little bit of steady state analysis plus losses / efficiency calculation)
% Reduction to (at most) 5 or 6 subquestions, i.e. a subset of the original exercises limited to some core questions for the buck converter
% Use a completely different set of parameter / signal values to change the setting compared to the exercise tasks, maybe also add a little 'pre story' for which application the buck converter should be used
% However, the 'spirit' of this first exam task should be definitely entry friendly, i.e., provide the students with a good start into the PE exam enabling to gain confidence for the next tasks 
%%%%%%%%%%%

In an industrial control system, a stable voltage of $\SI{24}{\volt}$ is available.
However, some devices require $\SI{48}{\volt}$. Hence, a step-up converter shall be designed for a load current according \autoref{table:ex01_Parameters of the circuit}.

\begin{germanblock}
In einem industriellen Steuerungssystem steht eine stabile DC-Spannung von $\SI{24}{\volt}$ zur Verfügung. Einige Geräte benötigen allerdings $\SI{48}{\volt}$. Hierfür wird ein Hochsetztsteller eingesetzt, 
der für einen Laststrom entsprechend \autoref{table:ex01_Parameters of the circuit} ausgelegt werden soll.
\end{germanblock}


% figure figStepDownConverterOutputFilter
\input{fig/Task01/figBoostConverter}

\begin{table}[ht]
    \centering  % Zentriert die Tabelle
    \begin{tabular}{llll}
        \toprule
        \multicolumn{2}{l}{\textbf{General parameters:}} & \multicolumn{2}{l}{\textbf{IGBT and diode:}} \\ 
        Input voltage: &  $U_{\mathrm{1}} = \SI{24}{\volt}$ & Drain-source voltage: & $U_{\mathrm{on},\mathrm{DS}} = \SI{1.2}{\volt}$ \\
        Output voltage: & $U_2 = \SI{48}{\volt}$  & Output current range: & $I_2 = \SI{2}{\ampere} \ldots \SI{20}{\ampere}$  \\
        Switching frequency: & $f_\mathrm{s} = \SI{100}{\kilo\hertz}$  & Diode forward voltage: & $U_{\mathrm{D},\mathrm{f}} = \SI{0.81}{\volt}$  \\
        \midrule
        \multicolumn{4}{l}{\quad The switching losses of the semiconductors are negligible.}  \\ 
        \multicolumn{4}{l}{\quad The filter capacitor $C$ is to be considered only for subtask 1.2.}  \\ 
        \bottomrule
    \end{tabular}
    \caption{Parameters of the circuit.}  % Beschriftung der Tabelle
    \label{table:ex01_Parameters of the circuit}
\end{table}

\subtask{Calculate the duty cycle and the minimal inductance in case of ideal components (no voltage drop  over transistor and diode), when the converter operates in BCM at minimum load.}{2}

\subtaskGerman{ Berechnen Sie den Tastgrad und die minimale Induktivität für den Fall idealer Komponenten (kein Spannungsabfall über dem Transistor oder der Diode),
  wenn der Hochsetzsteller bei minimaler Last im BCM arbeitet.}

% Solution of subtask
\begin{solutionblock}
    The duty cycle corresponds to
    \begin{equation*}
        \frac{U_\mathrm{2}}{U_\mathrm{1}}=\frac{1}{1-D}.
        \label{eq:voltage_ratio}
    \end{equation*}
    Solving this equation with respect to $D$ yields
    \begin{equation*}
        D=\frac{U_\mathrm{2}-U_\mathrm{1}}{U_\mathrm{2}}=\frac{\SI{48}{\volt}-\SI{24}{\volt}}{\SI{48}{\volt}}=0.5.
        \label{eq:dutycycle}
    \end{equation*}
    The average current $\overline{i}_\mathrm{1,min}$ is calculated by
    \begin{equation*}
       \overline{i}_\mathrm{1,min} = \frac {\overline{I}_\mathrm{2,min}}{1-D}= \frac{\SI{2}{\ampere}}{0.5}=\SI{4}{\ampere}.
    \end{equation*}
    The ripple current $\Delta i_\mathrm{L}$ yields
    \begin{equation*}
        \Delta i_\mathrm{L}=\frac{U_\mathrm{1} \cdot T_\mathrm{on}}{L} =\frac{U_\mathrm{1} \cdot D}{L \cdot f_\mathrm{s}}.
        \label{eq:u_on}
    \end{equation*}
    In case of boundary conduction mode following equation is to apply:
    \begin{equation*}
        \Delta i_\mathrm{L}= 2 \cdot \overline{i}_\mathrm{1,on}= 2 \cdot\ \SI{4}{\ampere} = \SI{8}{\ampere}.
    \end{equation*}
    The value of the inductance is to be calculated with
    \begin{equation*}
        \Delta i_\mathrm{L}= \frac{U_\mathrm{1}}{L} \cdot T_\mathrm{on} = \frac{U_\mathrm{1}}{L} \cdot \frac{D}{f_\mathrm{s}}. 
    \end{equation*}
    Solving this equation with respect to $L$ yields
    \begin{equation*}
        L= \frac{U_\mathrm{1}}{\Delta i_\mathrm{L}} \cdot \frac{D}{f_\mathrm{s}} = \frac{\SI{24}{\volt}}{\SI{8}{\ampere}} \cdot \frac{0.5}{\SI{100}{\kilo\hertz}} = \SI{15}{\micro\henry}.
    \end{equation*}
\end{solutionblock}


\subtask{ Some devices within the $\SI{48}{\volt}$ group tolerate an overvoltage of $\SI{5}{\percent}$. 
          Calculate the capacity of the smoothing capacitor $C$ to keep this limit assuming a constant load current $I_\mathrm{2}$. 
          What is the maximum voltage that can occur at the capacitor?}{2}%

\subtaskGerman{Einige Geräte innerhalb der $\SI{48}{\volt}$-Gruppe tolerieren eine Spannungsüberhöhung von $\SI{5}{\percent}$.
               Wie groß muss die Kapazität des Kondensator sein, um diese Spezifikation einzuhalten, sofern der Laststrom als konstant angenommen werden kann?
               Welche maximale Spannung am Kondensator kann dabei auftreten?}
              

% Solution of subtask
\begin{solutionblock}
    The maximum allowed voltage ripple results in:
    \begin{equation*}
        \Delta u_\mathrm{c}=0.05 \cdot U_\mathrm{2} =0.05 \cdot \SI{48}{\volt} = \SI{2.4}{\volt}.
    \end{equation*}
    The voltage drop of the capacitor corresponds to the integral of the capacitor current and the time, when the transistor is active:
    \begin{equation*}
        \Delta u_\mathrm{c}= \int_{0}^{T_\mathrm{on}} \frac{i_\mathrm{c}(t) }{C} \,\mathrm{d}t = \frac{I_\mathrm{2} D}{C f_\mathrm{s}}.
    \end{equation*}
    The highest load current of the capacitor corresponds to the highest negative output current, when the transistor is active.
    This leads to:
    \begin{equation*}
        \Delta u_\mathrm{c}= \frac{I_\mathrm{2,max} D}{C f_\mathrm{s}}.
    \end{equation*}
    Solving the previous equation to C yields
   \begin{equation*}
        C = \frac{I_\mathrm{2,max} D}{\Delta u_\mathrm{c} f_\mathrm{s}} = \frac{\SI{20}{\ampere} \cdot 0.5}{\SI{2.4}{\volt} \cdot \SI{100}{\kilo\hertz}}=\SI{41}{\micro\farad}.
   \end{equation*}
   The maximal voltage is calculated by
   \begin{equation*}
        u_\mathrm{c, max} = U_\mathrm{2} + \frac{\Delta u_\mathrm{c}}{2}  = \SI{48}{\volt} + \frac{\SI{2.4}{\volt}}{2}=\SI{49.2}{\volt}.
   \end{equation*}
\end{solutionblock}

\subtask{Calculate the duty cycle and the minimal inductance in case of ideal components, but consider the voltage drop over the transistor and the diode.
         The converter shall operates in BCM at minimum load.}{2}

\subtaskGerman{ Berechnen Sie den Tastgrad und die minimale Induktivität für den Fall idealer Komponenten, jedoch unter Berücksichtigung der Spannungsabfälle über dem Transistor und der Diode.
                Der Hochsetzsteller soll bei minimaler Last im BCM betrieben werden.}

% Solution of subtask
\begin{solutionblock}
    If the transistor is active the voltage at the inductance is calculated by
    \begin{equation*}
        U_\mathrm{L,on}=U_\mathrm{1}- U_{\mathrm{on},\mathrm{DS}} = \SI{24}{\volt} - \SI{2}{\volt} = \SI{22.8}{\volt}.
        \label{eq:voltage_ratio}
    \end{equation*}
    If the transistor is blocking the voltage at the inductance yields
    \begin{equation*}
        U_\mathrm{L,off}= U_\mathrm{1} - U_{\mathrm{D},\mathrm{f}} - U_\mathrm{2} = \SI{24}{\volt} - \SI{0.81}{\volt} - \SI{48}{\volt} = -\SI{24.81}{\volt}.
        \label{eq:voltage_ratio}
    \end{equation*}
    In steady state, the inductor's voltage-time integral must be zero over one switching period: 
    \begin{equation*}
        \frac{U_\mathrm{L,on} T_\mathrm{on} + U_\mathrm{L,off} T_\mathrm{off}}{L} = 0.
        \label{eq:voltage_ratio}
    \end{equation*}
    The substitution of $T_\mathrm{on}$ and $T_\mathrm{off}$ by the switching frequency and the duty cycle leads to
    \begin{equation*}
        U_\mathrm{L,on} \frac{D} {f_\mathrm{s}} + U_\mathrm{L,off} \frac{1-D} {f_\mathrm{s}} = 0.
        \label{eq:voltage_ratio}
    \end{equation*}
    Solving this equation with respect to $D$ yields
    \begin{equation*}
        D=\frac{-U_\mathrm{L,off}}{U_\mathrm{L,on}-U_\mathrm{L,off}}=\frac{-\SI{24.81}{\volt}}{-\SI{24.81}{\volt}-\SI{22.8}{\volt}}=0.52.
        \label{eq:dutycycle}
    \end{equation*}
    The average current $\overline{i}_\mathrm{1}$ is expressed by
   \begin{equation*}
       \overline{i}_\mathrm{1,min} = \frac {\overline{i}_\mathrm{2,min}}{1-D}= \frac {\SI{2}{\ampere}}{1-0.52}=\SI{4.18}{\ampere}.
   \end{equation*}
   In case of boundary conduction mode following equation is to apply:
   \begin{equation*}
       \Delta i_\mathrm{L}= 2 \cdot \overline{i}_\mathrm{1,min} = 2 \cdot\ \SI{4.18}{\ampere} = \SI{8.35}{\ampere}.
   \end{equation*}
   The ripple current $\Delta i_\mathrm{L}$ yields
   \begin{equation*}
       \Delta i_\mathrm{L}=\frac{U_\mathrm{L,on} \cdot T_\mathrm{on}}{L} =\frac{U_\mathrm{L,on} \cdot D}{L \cdot f_\mathrm{s}}.
   \end{equation*}
   Solving this equation with respect to $L$ yields
   \begin{equation*}
       L= \frac{U_\mathrm{L,on} \cdot D}{\Delta i_\mathrm{L} \cdot f_\mathrm{s}} = \frac{\SI{22.8}{\volt}}{\SI{8.35}{\ampere}} \cdot \frac{0.52}{\SI{100}{\kilo\hertz}} = \SI{14.2}{\micro\henry}.
   \end{equation*}
\end{solutionblock}


\subtask{Calculate the efficiency of the step-up converter at maximum load current considering the transistor and diode forward losses.
Moreover, sketch the curve of the voltage drop $u_\mathrm{L}(t)$  and the curves of the currents $i_\mathrm{D}(t)$ and $i_\mathrm{L}(t)$ in the diagrams below 
for this operating point and add the y-labels (assume $U_\mathrm{2}$ as constant).
}{1}%

\subtaskGerman{ Berechnen Sie den Wirkungsgrad des Hochsetzstellers bei maximalem Laststrom unter Berücksichtigung der Leitverluste von Diode und Transistor.
Skizzieren Sie zudem in den folgenden Diagrammen die Kurve des Spannungsabfalls $u_\mathrm{L}(t)$ und die Kurven der Ströme $i_\mathrm{D}(t)$ und $i_\mathrm{L}(t)$ 
für diesen Arbeitspunkt und fügen Sie die y-Achsenbeschriftungen hinzu (nehmen Sie $U_\mathrm{2}$ als konstant an).}

\input{fig/Task01/FigTask1Template}

% Solution of subtask
\begin{solutionblock}
    The input current 
    \begin{equation*}
        \overline{i}_\mathrm{1,max} = \frac {\overline{i}_\mathrm{2,max}}{1-D}= \frac {\SI{20}{\ampere}}{1-0.52}=\SI{41.8}{\ampere}. 
    \end{equation*}
    The efficiency of the step-up converter is calculated by
    \begin{equation*}
        \eta = \frac{P_\mathrm{2}} {P_\mathrm{1}} = \frac{U_\mathrm{2} I_\mathrm{2} } {U_\mathrm{1} \overline{i}_\mathrm{L} }
        = \frac{\SI{48}{\volt} \cdot \SI{20}{\ampere}}{\SI{24}{\volt} \cdot \SI{41.8}{\ampere}} = 0.96.
    \end{equation*}

    The values for $u_\mathrm{L}(t)$ are taken from subtask 1.3 ($U_\mathrm{L,on}$ and $U_\mathrm{L,off}$).
    The maximum and minimum current of the inductance results in
    \begin{equation*}
        \overline{i}_\mathrm{L,max} = \overline{i}_\mathrm{1,max} + \frac{\Delta i_\mathrm{L}}{2} = \SI{41.8}{\ampere} + \frac {\SI{8.35}{\ampere}}{2}=\SI{46}{\ampere} 
    \end{equation*}
    and 
    \begin{equation*}
        \overline{i}_\mathrm{L,max} = \overline{i}_\mathrm{1,max} - \frac{\Delta i_\mathrm{L}}{2} = \SI{41.8}{\ampere} - \frac {\SI{8.35}{\ampere}}{2}=\SI{37.6}{\ampere}. 
    \end{equation*}


\input{fig/Task01/sFigTask1}

\end{solutionblock}



